(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{39:function(t,e,n){"use strict";n.r(e);var c,r=n(0),i=n(20),a=n.n(i),o=n(3),s=n(4),j=n(5),u="token",b=function(t){localStorage.setItem(u,t)},l=function(){return localStorage.getItem(u)},d="https://student-json-api.lidemy.me",h=function(t){return fetch("".concat(d,"/posts?_sort=createdAt&_order=desc&_page=").concat(t,"&_limit=").concat(5)).then((function(t){return t.json()}))},O=function(){var t=l();return fetch("".concat(d,"/me"),{headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))},x=n(2),f=Object(r.createContext)(null),p=n(1),g=j.a.div(c||(c=Object(s.a)(["\n  color: red;\n"])));function v(){var t=Object(r.useContext)(f).setUser,e=Object(r.useState)(""),n=Object(o.a)(e,2),c=n[0],i=n[1],a=Object(r.useState)(""),s=Object(o.a)(a,2),j=s[0],u=s[1],l=Object(r.useState)(),h=Object(o.a)(l,2),v=h[0],m=h[1],S=Object(x.f)();return Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m(null),function(t,e){return fetch("".concat(d,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:e})}).then((function(t){return t.json()}))}(c,j).then((function(e){if(0===e.ok)return m(e.message);b(e.token),O().then((function(e){if(1!==e.ok)return b(null),m(e.toString());t(e.data),S.push("/")}))}))},children:[Object(p.jsxs)("div",{children:["username:"," ",Object(p.jsx)("input",{value:c,onChange:function(t){return i(t.target.value)}})]}),Object(p.jsxs)("div",{children:["password:"," ",Object(p.jsx)("input",{type:"password",value:j,onChange:function(t){return u(t.target.value)}})]}),Object(p.jsx)("button",{children:"\u767b\u5165"}),v&&Object(p.jsx)(g,{children:v})]})}var m,S,y,w,k,C,$,z=n(10),A=j.a.div(m||(m=Object(s.a)(["\n  width: 80%;\n"]))),_=j.a.div(S||(S=Object(s.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]))),E=Object(j.a)(z.b)(y||(y=Object(s.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n  cursor: pointer;\n"]))),J=j.a.div(w||(w=Object(s.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]))),D=j.a.div(k||(k=Object(s.a)(["\n  margin-top: 20px;\n  width: 100%\n  display: flex;\n"]))),I=j.a.button(C||(C=Object(s.a)(["\n  margin: 8px;\n  background: white;\n  width: 30px;\n  height: 30px;\n  border: 2px solid rgba(0, 12, 34, 0.2);\n  border-radius: 50%;\n  text-align: center;\n  font-weight: bold;\n  line-height: 1.8rem;\n  cursor: pointer;\n  ","\n"])),(function(t){return t.$active&&"\n    background: rgba(0, 12, 34, 0.2);\n    color: black;\n    "}));function P(t){var e=t.post;return Object(p.jsxs)(_,{children:[Object(p.jsx)(E,{to:"/posts/".concat(e.id),children:e.title}),Object(p.jsx)(J,{children:new Date(e.createdAt).toLocaleString()})]})}function U(){var t=Object(r.useState)([]),e=Object(o.a)(t,2),n=e[0],c=e[1],i=Object(r.useState)(1),a=Object(o.a)(i,2),s=a[0],j=a[1],u=Object(r.useState)([]),b=Object(o.a)(u,2),l=b[0],O=b[1];return Object(r.useEffect)((function(){h(s).then((function(t){O(t)})),fetch("".concat(d,"/posts?_sort=createdAt&_order=desc")).then((function(t){return t.json()})).then((function(t){var e=t.length%5===0?t.length/5:Math.ceil(t.length/5);c(Array.from({length:e},(function(t,e){return e+1})))}))}),[s]),Object(p.jsxs)(A,{children:[l.map((function(t){return Object(p.jsx)(P,{post:t},t.id)})),Object(p.jsx)(D,{children:n.map((function(t){return Object(p.jsx)(I,{$active:s===t,onClick:function(){!function(t){h(t).then((function(e){O(e),j(t)}))}(t)},children:t},t)}))})]})}function B(){var t=Object(r.useState)([]),e=Object(o.a)(t,2),n=e[0],c=e[1],i=Object(x.h)().id;return Object(r.useEffect)((function(){(function(t){return fetch("".concat(d,"/posts/").concat(t)).then((function(t){return t.json()}))})(i).then((function(t){return c(t)}))})),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:n.title}),Object(p.jsx)("p",{children:n.body}),Object(p.jsx)("p",{children:new Date(n.createdAt).toLocaleString()}),Object(p.jsxs)("p",{children:["author: ",n.userId]})]})}function F(){var t=Object(r.useContext)(f).user,e=Object(r.useState)(""),n=Object(o.a)(e,2),c=n[0],i=n[1],a=Object(r.useState)(""),s=Object(o.a)(a,2),j=s[0],u=s[1],b=Object(x.f)();return Object(r.useEffect)((function(){t||b.push("/")}),[t,b]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:"\u65b0\u589e\u6587\u7ae0"}),Object(p.jsxs)("form",{onSubmit:function(){(function(t,e){var n=l();return fetch("".concat(d,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:t,body:e})}).then((function(t){return t.json()}))})(c,j).then((function(t){b.push("/")}))},children:[Object(p.jsx)("h3",{children:"\u6587\u7ae0\u6a19\u984c"}),Object(p.jsx)("input",{value:c,onChange:function(t){i(t.target.value)}}),Object(p.jsx)("h3",{children:"\u6587\u7ae0\u5167\u5bb9"}),Object(p.jsx)("textarea",{value:j,onChange:function(t){u(t.target.value)}}),Object(p.jsx)("button",{type:"submit",children:" \u9001\u51fa "})]})]})}function N(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("p",{children:"About me~~~~~"})})}var T,L,M,q,G,H=j.a.div($||($=Object(s.a)(["\n  color: red;\n"])));function K(){var t=Object(r.useContext)(f).setUser,e=Object(r.useState)(""),n=Object(o.a)(e,2),c=n[0],i=n[1],a=Object(r.useState)(""),s=Object(o.a)(a,2),j=s[0],u=s[1],l=Object(r.useState)(""),h=Object(o.a)(l,2),g=h[0],v=h[1],m=Object(r.useState)(),S=Object(o.a)(m,2),y=S[0],w=S[1],k=Object(x.f)();return Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),w(null),function(t,e,n){return fetch("".concat(d,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,nickname:e,password:n})}).then((function(t){return t.json()}))}(c,j,g).then((function(e){if(0===e.ok)return w(e.message);b(e.token),O().then((function(e){if(1!==e.ok)return b(null),w(e.toString());console.log(e),t(e.data),k.push("/")}))}))},children:[Object(p.jsx)("h3",{children:"\u8a3b\u518a"}),Object(p.jsxs)("div",{children:["username:"," ",Object(p.jsx)("input",{type:"text",value:c,onChange:function(t){return i(t.target.value)}})]}),Object(p.jsxs)("div",{children:["nickname:"," ",Object(p.jsx)("input",{type:"text",value:j,onChange:function(t){return u(t.target.value)}})]}),Object(p.jsxs)("div",{children:["password:"," ",Object(p.jsx)("input",{type:"password",value:g,onChange:function(t){return v(t.target.value)}})]}),Object(p.jsx)("button",{children:"\u9001\u51fa"}),y&&Object(p.jsx)(H,{children:y})]})}var Q,R=j.a.div(T||(T=Object(s.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n  box-sizing: border-box;\n"]))),V=j.a.div(L||(L=Object(s.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]))),W=j.a.div(M||(M=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]))),X=Object(j.a)(z.b)(q||(q=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  width: 100px;\n  box-sizing: border-box;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"])),(function(t){return t.$active&&"\n    background: rgba(0,0,0,0.1)\n    "})),Y=j.a.div(G||(G=Object(s.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"])),W);function Z(){var t=Object(x.g)(),e=Object(x.f)(),n=Object(r.useContext)(f),c=n.user,i=n.setUser;return Object(p.jsxs)(R,{children:[Object(p.jsxs)(Y,{children:[Object(p.jsx)(V,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(p.jsxs)(W,{children:[Object(p.jsx)(X,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),c&&Object(p.jsx)(X,{to:"/new-post",$active:"/new-post"===t.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(p.jsxs)(W,{children:[Object(p.jsx)(X,{to:"/about",$active:"/about"===t.pathname,children:"\u95dc\u65bc"}),c&&Object(p.jsx)(X,{onClick:function(){b(""),i(null),"/"!==t.pathname&&e.push("/")},children:"\u767b\u51fa"}),!c&&Object(p.jsx)(X,{to:"/login",$active:"/login"===t.pathname,children:"\u767b\u5165"}),!c&&Object(p.jsx)(X,{to:"/register",$active:"/register"===t.pathname,children:"\u8a3b\u518a"})]})]})}var tt=j.a.div(Q||(Q=Object(s.a)(["\n  padding-top: 64px;\n"])));var et=function(){var t=Object(r.useState)(null),e=Object(o.a)(t,2),n=e[0],c=e[1];return Object(r.useEffect)((function(){O().then((function(t){t.ok&&c(t.data)}))}),[]),Object(p.jsx)(f.Provider,{value:{user:n,setUser:c},children:Object(p.jsx)(tt,{children:Object(p.jsxs)(z.a,{children:[Object(p.jsx)(Z,{}),Object(p.jsxs)(x.c,{children:[Object(p.jsx)(x.a,{exact:!0,path:"/",children:Object(p.jsx)(U,{})}),Object(p.jsx)(x.a,{path:"/login",children:Object(p.jsx)(v,{})}),Object(p.jsx)(x.a,{path:"/posts/:id",children:Object(p.jsx)(B,{})}),Object(p.jsx)(x.a,{path:"/new-post",children:Object(p.jsx)(F,{})}),Object(p.jsx)(x.a,{path:"/about",children:Object(p.jsx)(N,{})}),Object(p.jsx)(x.a,{path:"/register",children:Object(p.jsx)(K,{})})]})]})})})};a.a.render(Object(p.jsx)(et,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.63925380.chunk.js.map