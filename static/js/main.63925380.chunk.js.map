{"version":3,"sources":["utils.js","WebAPI.js","contexts.js","components/pages/LoginPage/LoginPage.js","components/pages/HomePage/HomePage.js","components/pages/PostPage/PostPage.js","components/pages/AddPage/AddPage.js","components/pages/AboutPage/AboutPage.js","components/pages/RegisterPage/RegisterPage.js","components/Header/Header.js","components/App/App.js","index.js"],"names":["TOKEN_NAME","setAuthToken","token","localStorage","setItem","getAuthToken","getItem","BASE_URL","getPostsByPage","page","fetch","then","res","json","getMe","headers","authorization","AuthContext","createContext","ErrorMessage","styled","div","LoginPage","setUser","useContext","useState","username","setUsername","password","setPassword","errorMessage","setErrorMessage","history","useHistory","onSubmit","e","preventDefault","method","body","JSON","stringify","login","data","ok","message","toString","push","value","onChange","target","type","Root","PostContainer","PostTitle","Link","PostDate","Paginator","PageButton","button","props","$active","Post","post","to","id","title","Date","createdAt","toLocaleString","HomePage","totalPages","setTotalPages","setPage","curretPosts","setCurretPosts","useEffect","posts","pages","length","Math","ceil","Array","from","v","i","map","p","onClick","handlePageChange","PostPage","setPost","useParams","getPost","userId","AddPage","user","postTitle","setPostTitle","postBody","setPostBody","addPost","AboutPage","nickname","setNickname","register","console","log","HeaderContainer","Brand","NavbarList","Nav","LeftContainer","Header","location","useLocation","pathname","App","response","Provider","exact","path","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.63925380.chunk.js","sourcesContent":["const TOKEN_NAME = \"token\";\n\nexport const setAuthToken = (token) => {\n  localStorage.setItem(TOKEN_NAME, token);\n};\n\nexport const getAuthToken = () => {\n  return localStorage.getItem(TOKEN_NAME);\n};\n","import { getAuthToken } from \"./utils.js\";\nconst BASE_URL = \"https://student-json-api.lidemy.me\";\n\nexport const limit = 5;\n\nexport const getPosts = () => {\n  return fetch(`${BASE_URL}/posts?_sort=createdAt&_order=desc`).then((res) =>\n    res.json()\n  );\n};\n\nexport const getPostsByPage = (page) => {\n  return fetch(\n    `${BASE_URL}/posts?_sort=createdAt&_order=desc&_page=${page}&_limit=${limit}`\n  ).then((res) => res.json());\n};\n\nexport const getPost = (id) => {\n  return fetch(`${BASE_URL}/posts/${id}`).then((res) => res.json());\n};\n\nexport const register = (username, nickname, password) => {\n  return fetch(`${BASE_URL}/register`, {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      username,\n      nickname,\n      password,\n    }),\n  }).then((res) => res.json());\n};\n\nexport const login = (username, password) => {\n  return fetch(`${BASE_URL}/login`, {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      username,\n      password,\n    }),\n  }).then((res) => res.json());\n};\n\nexport const getMe = () => {\n  const token = getAuthToken();\n  return fetch(`${BASE_URL}/me`, {\n    headers: {\n      authorization: `Bearer ${token}`,\n    },\n  }).then((res) => res.json());\n};\n\nexport const addPost = (title, body) => {\n  const token = getAuthToken();\n  return fetch(`${BASE_URL}/posts`, {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n      authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify({\n      title,\n      body,\n    }),\n  }).then((res) => res.json());\n};\n","import { createContext } from \"react\";\n\nexport const AuthContext = createContext(null);\n","import React, { useState, useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { login, getMe } from \"../../../WebAPI.js\";\nimport { setAuthToken } from \"../../../utils.js\";\nimport { useHistory } from \"react-router-dom\";\nimport { AuthContext } from \"../../../contexts.js\";\n\nconst ErrorMessage = styled.div`\n  color: red;\n`;\nexport default function LoginPage() {\n  const { setUser } = useContext(AuthContext);\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState();\n  const history = useHistory();\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setErrorMessage(null);\n    login(username, password).then((data) => {\n      if (data.ok === 0) {\n        return setErrorMessage(data.message);\n      }\n      setAuthToken(data.token);\n\n      getMe().then((data) => {\n        if (data.ok !== 1) {\n          setAuthToken(null);\n          return setErrorMessage(data.toString());\n        }\n        setUser(data.data);\n        history.push(\"/\");\n      });\n    });\n  };\n  return (\n    <form onSubmit={handleSubmit}>\n      <div>\n        username:{\" \"}\n        <input value={username} onChange={(e) => setUsername(e.target.value)} />\n      </div>\n      <div>\n        password:{\" \"}\n        <input\n          type=\"password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n        />\n      </div>\n      <button>登入</button>\n      {errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage>}\n    </form>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport PropTypes from \"prop-types\";\nimport { Link } from \"react-router-dom\";\nimport { limit, getPosts, getPostsByPage } from \"../../../WebAPI\";\n\nconst Root = styled.div`\n  width: 80%;\n`;\n\nconst PostContainer = styled.div`\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n`;\nconst PostTitle = styled(Link)`\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n  cursor: pointer;\n`;\n\nconst PostDate = styled.div`\n  color: rgba(0, 0, 0, 0.8);\n`;\n\nconst Paginator = styled.div`\n  margin-top: 20px;\n  width: 100%\n  display: flex;\n`;\n\nconst PageButton = styled.button`\n  margin: 8px;\n  background: white;\n  width: 30px;\n  height: 30px;\n  border: 2px solid rgba(0, 12, 34, 0.2);\n  border-radius: 50%;\n  text-align: center;\n  font-weight: bold;\n  line-height: 1.8rem;\n  cursor: pointer;\n  ${(props) =>\n    props.$active &&\n    `\n    background: rgba(0, 12, 34, 0.2);\n    color: black;\n    `}\n`;\n\nfunction Post({ post }) {\n  return (\n    <PostContainer>\n      <PostTitle to={`/posts/${post.id}`}>{post.title}</PostTitle>\n      <PostDate>{new Date(post.createdAt).toLocaleString()}</PostDate>\n    </PostContainer>\n  );\n}\n\nPost.propTypes = {\n  post: PropTypes.object,\n};\n\nexport default function HomePage() {\n  const [totalPages, setTotalPages] = useState([]);\n  const [page, setPage] = useState(1);\n  const [curretPosts, setCurretPosts] = useState([]);\n\n  const handlePageChange = (p) => {\n    getPostsByPage(p).then((curretPosts) => {\n      setCurretPosts(curretPosts);\n      setPage(p);\n    });\n  };\n\n  useEffect(() => {\n    getPostsByPage(page).then((curretPosts) => {\n      setCurretPosts(curretPosts);\n    });\n    getPosts().then((posts) => {\n      const pages =\n        posts.length % limit === 0\n          ? posts.length / limit\n          : Math.ceil(posts.length / limit);\n      setTotalPages(Array.from({ length: pages }, (v, i) => i + 1));\n    });\n  }, [page]);\n\n  return (\n    <Root>\n      {curretPosts.map((post) => (\n        <Post key={post.id} post={post}></Post>\n      ))}\n      <Paginator>\n        {totalPages.map((p) => (\n          <PageButton\n            key={p}\n            $active={page === p}\n            onClick={() => {\n              handlePageChange(p);\n            }}\n          >\n            {p}\n          </PageButton>\n        ))}\n      </Paginator>\n    </Root>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { getPost } from \"../../../WebAPI\";\nimport { useParams } from \"react-router-dom\";\n\nexport default function PostPage() {\n  const [post, setPost] = useState([]);\n  const { id } = useParams();\n\n  useEffect(() => {\n    getPost(id).then((p) => setPost(p));\n  });\n\n  return (\n    <>\n      <h2>{post.title}</h2>\n      <p>{post.body}</p>\n      <p>{new Date(post.createdAt).toLocaleString()}</p>\n      <p>author: {post.userId}</p>\n    </>\n  );\n}\n","import React, { useState, useEffect, useContext } from \"react\";\nimport { addPost } from \"../../../WebAPI.js\";\nimport { useHistory } from \"react-router-dom\";\nimport { AuthContext } from \"../../../contexts.js\";\n\nexport default function AddPage() {\n  const { user } = useContext(AuthContext);\n  const [postTitle, setPostTitle] = useState(\"\");\n  const [postBody, setPostBody] = useState(\"\");\n  const history = useHistory();\n\n  const handleSubmit = () => {\n    addPost(postTitle, postBody).then((data) => {\n      history.push(\"/\");\n    });\n  };\n\n  useEffect(() => {\n    if (!user) {\n      history.push(\"/\");\n    }\n  }, [user, history]);\n\n  return (\n    <>\n      <h2>新增文章</h2>\n      <form onSubmit={handleSubmit}>\n        <h3>文章標題</h3>\n        <input\n          value={postTitle}\n          onChange={(e) => {\n            setPostTitle(e.target.value);\n          }}\n        />\n        <h3>文章內容</h3>\n        <textarea\n          value={postBody}\n          onChange={(e) => {\n            setPostBody(e.target.value);\n          }}\n        />\n        <button type=\"submit\"> 送出 </button>\n      </form>\n    </>\n  );\n}\n","import React from \"react\";\nexport default function AboutPage() {\n  return (\n    <>\n      <p>About me~~~~~</p>\n    </>\n  );\n}\n","import React, { useState, useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { register, getMe } from \"../../../WebAPI.js\";\nimport { setAuthToken } from \"../../../utils.js\";\nimport { useHistory } from \"react-router-dom\";\nimport { AuthContext } from \"../../../contexts.js\";\n\nconst ErrorMessage = styled.div`\n  color: red;\n`;\nexport default function LoginPage() {\n  const { setUser } = useContext(AuthContext);\n  const [username, setUsername] = useState(\"\");\n  const [nickname, setNickname] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState();\n  const history = useHistory();\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setErrorMessage(null);\n    register(username, nickname, password).then((data) => {\n      if (data.ok === 0) {\n        return setErrorMessage(data.message);\n      }\n      setAuthToken(data.token);\n\n      getMe().then((data) => {\n        if (data.ok !== 1) {\n          setAuthToken(null);\n          return setErrorMessage(data.toString());\n        }\n        console.log(data);\n        setUser(data.data);\n        history.push(\"/\");\n      });\n    });\n  };\n  return (\n    <form onSubmit={handleSubmit}>\n      <h3>註冊</h3>\n      <div>\n        username:{\" \"}\n        <input\n          type=\"text\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n        />\n      </div>\n      <div>\n        nickname:{\" \"}\n        <input\n          type=\"text\"\n          value={nickname}\n          onChange={(e) => setNickname(e.target.value)}\n        />\n      </div>\n      <div>\n        password:{\" \"}\n        <input\n          type=\"password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n        />\n      </div>\n      <button>送出</button>\n      {errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage>}\n    </form>\n  );\n}\n","import React, { useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { Link, useLocation, useHistory } from \"react-router-dom\";\nimport { AuthContext } from \"../../contexts.js\";\nimport { setAuthToken } from \"../../utils.js\";\n\nconst HeaderContainer = styled.div`\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n  box-sizing: border-box;\n`;\n\nconst Brand = styled.div`\n  font-size: 32px;\n  font-weight: bold;\n`;\n\nconst NavbarList = styled.div`\n  display: flex;\n  align-items: center;\n  height: 64px;\n`;\nconst Nav = styled(Link)`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  width: 100px;\n  box-sizing: border-box;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ${(props) =>\n    props.$active &&\n    `\n    background: rgba(0,0,0,0.1)\n    `}\n`;\n\nconst LeftContainer = styled.div`\n  display: flex;\n  align-items: center;\n\n  ${NavbarList} {\n    margin-left: 64px;\n  }\n`;\n\nexport default function Header() {\n  const location = useLocation();\n  const history = useHistory();\n  const { user, setUser } = useContext(AuthContext);\n\n  const handleLogout = () => {\n    setAuthToken(\"\");\n    setUser(null);\n    if (location.pathname !== \"/\") {\n      history.push(\"/\");\n    }\n  };\n\n  return (\n    <HeaderContainer>\n      <LeftContainer>\n        <Brand>我的第一個部落格</Brand>\n        <NavbarList>\n          <Nav to=\"/\" $active={location.pathname === \"/\"}>\n            首頁\n          </Nav>\n          {user && (\n            <Nav to=\"/new-post\" $active={location.pathname === \"/new-post\"}>\n              發布文章\n            </Nav>\n          )}\n        </NavbarList>\n      </LeftContainer>\n      <NavbarList>\n        <Nav to=\"/about\" $active={location.pathname === \"/about\"}>\n          關於\n        </Nav>\n        {user && <Nav onClick={handleLogout}>登出</Nav>}\n        {!user && (\n          <Nav to=\"/login\" $active={location.pathname === \"/login\"}>\n            登入\n          </Nav>\n        )}\n        {!user && (\n          <Nav to=\"/register\" $active={location.pathname === \"/register\"}>\n            註冊\n          </Nav>\n        )}\n      </NavbarList>\n    </HeaderContainer>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport LoginPage from \"../pages/LoginPage\";\nimport HomePage from \"../pages/HomePage\";\nimport PostPage from \"../pages/PostPage\";\nimport AddPage from \"../pages/AddPage\";\nimport AboutPage from \"../pages/AboutPage\";\nimport RegisterPage from \"../pages/RegisterPage\";\nimport Header from \"../Header\";\nimport { AuthContext } from \"../../contexts.js\";\nimport { getMe } from \"../../WebAPI.js\";\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\n\nconst Root = styled.div`\n  padding-top: 64px;\n`;\n\nfunction App() {\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    getMe().then((response) => {\n      if (response.ok) {\n        setUser(response.data);\n      }\n    });\n  }, []);\n  return (\n    <AuthContext.Provider value={{ user, setUser }}>\n      <Root>\n        <Router>\n          <Header />\n          <Switch>\n            <Route exact path=\"/\">\n              <HomePage />\n            </Route>\n            <Route path=\"/login\">\n              <LoginPage />\n            </Route>\n            <Route path=\"/posts/:id\">\n              <PostPage />\n            </Route>\n            <Route path=\"/new-post\">\n              <AddPage />\n            </Route>\n            <Route path=\"/about\">\n              <AboutPage />\n            </Route>\n            <Route path=\"/register\">\n              <RegisterPage />\n            </Route>\n          </Switch>\n        </Router>\n      </Root>\n    </AuthContext.Provider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}